"0","# function to compute (adjusted) R^2 based on the design"
"0","# matrix, the response vector and the estimated"
"0","# coefficients"
"0","R2 <- function(X, y, betas){"
"0","    f <- c(X %*% betas)"
"0","    R2 <- cor(f, y)^2"
"0","    return(R2)"
"0","}"
"0",""
"0","adjR2 <- function(X, y, betas){"
"0","    R2 <- R2(X,y, betas)"
"0","    n <- nrow(X)"
"0","    cnst <- (n - 1)/(n - length(betas))"
"0","    out <- 1 - (1 - R2)*cnst"
"0","    return(out)"
"0","}"
