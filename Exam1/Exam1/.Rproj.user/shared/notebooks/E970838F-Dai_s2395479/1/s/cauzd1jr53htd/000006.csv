"0",""
"0","grade_analysis <- function(the_grades){"
"0"," list_grade <- list()"
"0"," E_1 <- the_grades$Exam1 "
"0"," E_1[is.na(E_1)] <- 10"
"0"," E_2 <- the_grades$Exam2"
"0"," E_2[is.na(E_2)] <- 10"
"0"," E <- (E_2 + max(E_1, E_2)) / 2   "
"0"," A <- the_grades$Assignment  "
"0"," A[is.na(A)] <- 10"
"0"," Y <- (2*E + A)/3"
"0"," Y <- ifelse((E>=50 & E_2 >=50 & A>=50), Y, min(50,Y))"
"0"," list_grade[['if_pass']] <- factor(Y>=55, labels =c('resit','passed'))"
"0"," list_grade[['final_grade']] <- Y"
"0"," return(list_grade)"
"0","}"
